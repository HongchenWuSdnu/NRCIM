<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>è‡ªç„¶èµ„æºåœ°ç†ä¿¡æ¯åˆ†ç±»åˆ†çº§ä¸å¤šå°ºåº¦å®‰å…¨æŒ‡æ ‡ä½“ç³»æ„å»ºç³»ç»Ÿ</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
  :root{
    --bg:#f3f6fb; --panel:#ffffff; --line:#e8edf3; --text:#0f172a; --muted:#64748b;
    --brand:#2563eb; --radius:14px; --shadow:0 8px 20px rgba(16,24,40,.06); --chip:#f4f7fe;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);
       font:14px/1.55 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"PingFang SC","Microsoft YaHei",sans-serif}
  .app{display:flex;min-height:100vh}

  /* ä¾§æ  */
  .sider{width:240px;background:linear-gradient(180deg,#0f1b31,#0a1326);color:#dbe7ff;padding:18px 12px 20px;position:sticky;top:0;height:100vh}
  .brand{display:flex;align-items:center;gap:10px;height:44px;border-radius:10px;background:#0b1630;padding:0 12px}
  .brand .dot{width:18px;height:18px;border-radius:6px;background:linear-gradient(135deg,#2563eb,#22c55e)}
  .brand b{font-weight:700}
  .menu{margin-top:8px}
  .menu h4{margin:14px 12px 8px;color:#9fb3e6;font-size:12px}
  .item{display:flex;align-items:center;gap:10px;color:#dbe7ff;padding:10px 12px;border-radius:10px;text-decoration:none;cursor:pointer}
  .item:hover{background:rgba(255,255,255,.06)}
  .item.active{background:#1a2a52}
  .ico{width:8px;height:8px;border-radius:50%;background:#67a1ff}

  /* ä¸»åŒº */
  .main{flex:1; padding:22px 28px 40px; overflow:auto}
  .title{background:#fff;border:1px solid var(--line);box-shadow:var(--shadow);border-radius:var(--radius);padding:14px 18px;margin-bottom:16px;text-align:center;font-weight:800;font-size:18px}

  /* é€šç”¨å®¹å™¨/å¡ç‰‡/æŒ‰é’®/å¾½ç« /è¡¨æ ¼ */
  .block,.chart-wrap{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow)}
  .hd{padding:14px 16px;border-bottom:1px solid var(--line);font-weight:700}
  .bd{padding:16px}
  .btn{border:1px solid transparent;background:var(--brand);color:#fff;border-radius:10px;padding:8px 12px;font-size:14px;cursor:pointer}
  .btn.ghost{background:#fff;border-color:#cfd8e3;color:#1f2937}
  .badge{display:inline-block;padding:3px 8px;border-radius:999px;font-size:12px;border:1px solid #e5e7eb;background:var(--chip);color:#334155}
  .badge.blue{border-color:#bfdbfe;background:#eff6ff;color:#1d4ed8}
  .badge.gray{color:#475569}
  table{width:100%;border-collapse:separate;border-spacing:0 10px}
  thead th{padding:10px 12px;color:#6b7280;font-size:12px;text-align:left}
  tbody td{background:#fff;border:1px solid var(--line);border-left:none;border-right:none;padding:12px;vertical-align:top}
  tbody tr{box-shadow:var(--shadow)}
  tbody td:first-child{border-left:1px solid var(--line);border-top-left-radius:12px;border-bottom-left-radius:12px}
  tbody td:last-child{border-right:1px solid var(--line);border-top-right-radius:12px;border-bottom-right-radius:12px}
  .muted{color:#6b7280}
  .actions{display:flex;gap:10px;align-items:center}
  .link{color:#2563eb;cursor:pointer}
  .link.danger{color:#ef4444}

  /* åˆ†é¡µ */
  .pager{display:flex;align-items:center;gap:10px;margin-top:12px;color:#475569}
  .pager .page{padding:6px 10px;border:1px solid #cfd8e3;border-radius:8px;background:#fff;cursor:pointer}
  .pager .page.active{border-color:#2563eb;color:#2563eb}
  .select{padding:6px 8px;border:1px solid #cfd8e3;border-radius:8px;background:#fff}

  /* KPI & Chartsï¼ˆä»ªè¡¨ç›˜ï¼‰ */
  .cards{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:14px 16px;box-shadow:var(--shadow)}
  .k-top{font-size:13px;color:#475569}
  .k-val{font-size:28px;font-weight:800}
  .kpi-sub{color:#94a3b8;font-size:12px;margin-top:2px}
  .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:16px;margin-top:16px}
  .legend{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:10px}
  .tag{display:flex;align-items:center;gap:6px;font-size:12px;color:#334155}
  .dot{width:10px;height:10px;border-radius:50%}

  /* è¿›åº¦æ¡ï¼ˆå¤‡ç”¨æ ·å¼ï¼‰ */
  .bar{display:flex;align-items:center;gap:12px;margin:14px 0}
  .bar .name{width:96px;color:#475569;font-size:12px}
  .track{flex:1;height:10px;background:#eef2ff;border-radius:999px;overflow:hidden}
  .fill{height:100%;background:linear-gradient(90deg,#3b82f6,#60a5fa)}
  .pct{width:48px;text-align:right;color:#475569;font-size:12px}

  /* å¼¹çª—&æç¤º */
  .mask{position:fixed;inset:0;background:rgba(15,23,42,.38);display:none;align-items:center;justify-content:center;z-index:50}
  .dialog{width:560px;max-width:92vw;background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:var(--shadow)}
  .dialog .hd{border-bottom:1px solid var(--line)}
  .form{display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center}
  .form label{color:#475569}
  .form input,.form select,.form textarea{width:100%;padding:8px 10px;border:1px solid #cfd8e3;border-radius:8px;background:#fff}
  .form textarea{min-height:84px;resize:vertical}
  .toast{position:fixed;right:16px;bottom:16px;background:#111827;color:#fff;padding:10px 12px;border-radius:8px;opacity:0;transform:translateY(8px);transition:all .25s;z-index:60}
  .toast.show{opacity:1;transform:translateY(0)}

  /* å“åº”å¼ */
  @media (max-width:1200px){ .cards{grid-template-columns:repeat(2,1fr)} .grid{grid-template-columns:1fr} .sider{width:220px} }
  @media (max-width:860px){ .sider{display:none} .cards{grid-template-columns:1fr} .form{grid-template-columns:1fr} }
</style>
</head>
<body>
<div class="app">

  <!-- ä¾§è¾¹æ  -->
  <aside class="sider">
    <div class="brand"><span class="dot"></span><b>NRCIM æ§åˆ¶å°</b></div>
    <nav class="menu">
      <h4>å¯¼èˆª</h4>
      <div class="item active" data-route="dashboard"><span class="ico"></span> ä»ªè¡¨ç›˜</div>
      <div class="item" data-route="types"><span class="ico"></span> èµ„æºç±»å‹ç®¡ç†</div>
      <div class="item" data-route="indicators"><span class="ico"></span> æŒ‡æ ‡ä½“ç³»ç®¡ç†</div>
      <div class="item" data-route="modules"><span class="ico"></span> æ¨¡å—ç®¡ç†</div>
      <div class="item" data-route="regions"><span class="ico"></span> åŒºåŸŸç®¡ç†</div>
      <div class="item" data-route="observations"><span class="ico"></span> è§‚æµ‹æ•°æ®</div>
    </nav>
  </aside>

  <!-- ä¸»ä½“ -->
  <main class="main">
    <div class="title">è‡ªç„¶èµ„æºåœ°ç†ä¿¡æ¯åˆ†ç±»åˆ†çº§ä¸å¤šå°ºåº¦å®‰å…¨æŒ‡æ ‡ä½“ç³»æ„å»ºç³»ç»Ÿ</div>

    <!-- ä»ªè¡¨ç›˜ï¼ˆæ–°æ ·å¼ï¼‰ -->
    <section id="view-dashboard" class="view">
      <section class="cards">
        <div class="card">
          <div class="k-top">èµ„æºç±»å‹</div>
          <div class="k-val">4</div>
          <div class="kpi-sub">æ°”å€™ / åœ°è¡¨è¦†ç›– / æ°´ / åœŸåœ°</div>
        </div>
        <div class="card">
          <div class="k-top">æŒ‡æ ‡æ€»æ•°</div>
          <div class="k-val">16</div>
          <div class="kpi-sub">ä¸‰çº§æŒ‡æ ‡ä½“ç³»</div>
        </div>
        <div class="card">
          <div class="k-top">åŒºåŸŸæ•°</div>
          <div class="k-val">6</div>
          <div class="kpi-sub">é™†åœ°æ°´é¢åŒº Â· æ¤è¢«è¦†ç›–åŒº Â· è£¸åœ°åŒº Â· å†°å·Â·å†»åœŸåŒº Â· è¿‡æ¸¡åŒº</div>
        </div>
        <div class="card">
          <div class="k-top">è§‚æµ‹è®°å½•</div>
          <div class="k-val">14</div>
          <div class="kpi-sub">å…¸å‹æ—¶ç©ºæˆªé¢</div>
        </div>
      </section>

      <div class="grid">
        <section class="chart-wrap">
          <div class="hd">èµ„æºç±»å‹å æ¯”</div>
          <div class="bd">
            <div class="legend" style="margin-bottom:12px">
              <span class="tag"><span class="dot" style="background:#4f76ff"></span> æ°”å€™</span>
              <span class="tag"><span class="dot" style="background:#56bf6b"></span> åœ°è¡¨è¦†ç›–</span>
              <span class="tag"><span class="dot" style="background:#f5c34d"></span> æ°´</span>
              <span class="tag"><span class="dot" style="background:#ef6b63"></span> åœŸåœ°</span>
            </div>
            <canvas id="pie" height="220"></canvas>
          </div>
        </section>

        <section class="chart-wrap">
          <div class="hd">èµ„æºè´¨é‡ï¼ˆç¤ºä¾‹æŒ‡æ ‡æ ‡å‡†åŒ–å¾—åˆ†ï¼‰</div>
          <div class="bd">
            <canvas id="barNorm" height="240"></canvas>
          </div>
        </section>
      </div>

      <section class="chart-wrap" style="margin-top:16px">
        <div class="bd" style="padding-top:10px">
          <table>
            <thead>
              <tr>
                <th style="width:16%">æ—¶é—´</th>
                <th style="width:18%">åŒºåŸŸ</th>
                <th style="width:10%">èµ„æºç±»å‹</th>
                <th style="width:18%">æŒ‡æ ‡åç§°</th>
                <th style="width:10%">å€¼</th>
                <th style="width:10%">å•ä½</th>
                <th style="width:12%">é‡‡é›†æ–¹å¼</th>
                <th style="width:10%">æ ‡ç­¾</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>2024-01-15 10:00</td><td class="muted">é•¿æ±Ÿä¸­ä¸‹æ¸¸é™†åœ°æ°´é¢åŒº</td><td>æ°”å€™</td><td>å¹´é™æ°´æ€»é‡</td><td>1200</td><td>mm</td><td>è‡ªåŠ¨ç›‘æµ‹</td><td><span class="badge blue">å…¸å‹æ ·ä¾‹</span></td></tr>
              <tr><td>2024-01-15 10:00</td><td class="muted">é•¿æ±Ÿä¸­ä¸‹æ¸¸é™†åœ°æ°´é¢åŒº</td><td>æ°´</td><td>åœ°è¡¨æ°´å‚¨é‡</td><td>850.5</td><td>ä¸‡mÂ³</td><td>äººå·¥è§‚æµ‹</td><td><span class="badge blue">I ç±»æ°´åŸŸ</span></td></tr>
              <tr><td>2024-01-16 09:00</td><td class="muted">ä¸œåŒ—å¤§å…´å®‰å²­æ¤è¢«è¦†ç›–åŒº</td><td>åœ°è¡¨è¦†ç›–</td><td>æ£®æ—è¦†ç›–ç‡</td><td>82.3</td><td>%</td><td>é¥æ„Ÿç›‘æµ‹</td><td><span class="badge blue">é«˜è¦†ç›–</span></td></tr>
              <tr><td>2024-01-18 12:00</td><td class="muted">é’è—é«˜åŸå†°å·Â·å†»åœŸåŒº</td><td>æ°”å€™</td><td>å¹´å¤ªé˜³è¾å°„æ€»é‡</td><td>6800</td><td>MJ/mÂ²</td><td>è‡ªåŠ¨ç›‘æµ‹</td><td><span class="badge blue">é«˜è¾å°„</span></td></tr>
              <tr><td>2024-01-20 13:00</td><td class="muted">æ¸¤æµ·æ¹¾æµ·å²¸åŒº</td><td>åœ°è¡¨è¦†ç›–</td><td>è‰åœ°ç”Ÿäº§åŠ›</td><td>2850</td><td>kg/hmÂ²</td><td>å®åœ°è°ƒæŸ¥</td><td><span class="badge blue">æ²¿æµ·å¸¦</span></td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- èµ„æºç±»å‹ç®¡ç† -->
    <section id="view-types" class="view" style="display:none">
      <section class="block">
        <div class="hd" style="display:flex;justify-content:space-between;align-items:center">
          <div>èµ„æºç±»å‹ç®¡ç†</div>
          <button class="btn" data-open="type">ï¼‹ æ·»åŠ èµ„æºç±»å‹</button>
        </div>
        <div class="bd">
          <table id="types-table"></table>
          <div class="pager" id="types-pager"></div>
        </div>
      </section>
    </section>

    <!-- æŒ‡æ ‡ä½“ç³»ç®¡ç† -->
    <section id="view-indicators" class="view" style="display:none">
      <section class="block">
        <div class="hd" style="display:flex;justify-content:space-between;align-items:center">
          <div>æŒ‡æ ‡ä½“ç³»ç®¡ç†</div>
          <button class="btn" data-open="indicator">ï¼‹ æ·»åŠ æŒ‡æ ‡</button>
        </div>
        <div class="bd">
          <table id="indicators-table"></table>
          <div class="pager" id="indicators-pager"></div>
        </div>
      </section>
    </section>

    <!-- æ¨¡å—ç®¡ç† -->
    <section id="view-modules" class="view" style="display:none">
      <section class="block">
        <div class="hd" style="display:flex;justify-content:space-between;align-items:center">
          <div>æ¨¡å—ç®¡ç†</div>
          <button class="btn" data-open="module">ï¼‹ æ·»åŠ æ¨¡å—</button>
        </div>
        <div class="bd">
          <table id="modules-table"></table>
          <div class="pager" id="modules-pager"></div>
        </div>
      </section>
    </section>

    <!-- åŒºåŸŸç®¡ç† -->
    <section id="view-regions" class="view" style="display:none">
      <section class="block">
        <div class="hd" style="display:flex;justify-content:space-between;align-items:center">
          <div>åŒºåŸŸç®¡ç†</div>
          <button class="btn" data-open="region">ï¼‹ æ·»åŠ åŒºåŸŸ</button>
        </div>
        <div class="bd">
          <table id="regions-table"></table>
          <div class="pager" id="regions-pager"></div>
        </div>
      </section>
    </section>

    <!-- è§‚æµ‹æ•°æ® -->
    <section id="view-observations" class="view" style="display:none">
      <section class="block">
        <div class="hd" style="display:flex;justify-content:space-between;align-items:center">
          <div>è§‚æµ‹æ•°æ®ç®¡ç†</div>
          <button class="btn" data-open="ob">ï¼‹ æ·»åŠ è§‚æµ‹æ•°æ®</button>
        </div>
        <div class="bd">
          <table id="obs-table"></table>
          <div class="pager" id="obs-pager"></div>
        </div>
      </section>
    </section>
  </main>
</div>

<!-- é€šç”¨å¼¹çª— -->
<div class="mask" id="mask">
  <div class="dialog">
    <div class="hd"><div id="dlg-title" style="font-weight:700">æ–°å»º</div></div>
    <div class="bd">
      <form id="dlg-form" class="form"></form>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:14px">
        <button class="btn ghost" type="button" id="dlg-cancel">å–æ¶ˆ</button>
        <button class="btn" type="submit" id="dlg-ok">ä¿å­˜</button>
      </div>
    </div>
  </div>
</div>
<div class="toast" id="toast">å·²ä¿å­˜</div>

<script>
/* ========== ä»ªè¡¨ç›˜å›¾è¡¨ ========== */
const pieInit = () => new Chart(document.getElementById('pie'),{
  type:'doughnut',
  data:{
    labels:['æ°”å€™','åœ°è¡¨è¦†ç›–','æ°´','åœŸåœ°'],
    datasets:[{
      data:[28,26,24,22],
      borderWidth:0,
      cutout:'62%',
      backgroundColor:['#4f76ff','#56bf6b','#f5c34d','#ef6b63']
    }]
  },
  options:{plugins:{legend:{display:false}},layout:{padding:8}}
});
const barInit = () => new Chart(document.getElementById('barNorm'),{
  type:'bar',
  data:{
    labels:['é™æ°´å˜å¼‚ç³»æ•°','åœŸå£¤æœ‰æœºè´¨','æ£®æ—è¦†ç›–ç‡','æ°´è´¨æŒ‡æ•°'],
    datasets:[{data:[65,72,78,86],borderWidth:0,borderRadius:8,backgroundColor:'#5177f6'}]
  },
  options:{
    indexAxis:'y',
    scales:{ x:{min:0,max:100,grid:{display:false},ticks:{callback:v=>v+'%'}}, y:{grid:{display:false}} },
    plugins:{legend:{display:false},tooltip:{callbacks:{label:(c)=>`${c.parsed.x}%`}}}
  }
});

/* ========== è·¯ç”± ========== */
const routes = ['dashboard','types','indicators','modules','regions','observations'];
const showView = (name) => {
  document.querySelectorAll('.view').forEach(v=>v.style.display='none');
  document.getElementById('view-'+name).style.display='';
  document.querySelectorAll('.item').forEach(i=>i.classList.toggle('active', i.dataset.route===name));
  if(name==='dashboard' && !window._chartsInited){ pieInit(); barInit(); window._chartsInited = true; }
  location.hash = name;
};
document.querySelectorAll('.item').forEach(i=>i.onclick=()=>showView(i.dataset.route));
window.addEventListener('load', ()=>{
  const r = routes.includes(location.hash.slice(1))? location.hash.slice(1): 'dashboard';
  showView(r);
});

/* ========== å†…å­˜æ•°æ® ========== */
const dataStore = {
  types: [
    {id:1,name:'åœŸåœ°èµ„æº',cat:'land',desc:'å†œç”¨åœ°ï¼ˆæ—åœ°ã€è‰åœ°ã€è€•åœ°ï¼‰',time:'2025/8/6 10:04:18'},
    {id:2,name:'åœ°è¡¨è¦†ç›–',cat:'surface',desc:'æ—æœ¨ã€è‰ã€ä½œç‰©',time:'2025/8/6 10:04:18'},
    {id:3,name:'æ°”å€™èµ„æº',cat:'climate',desc:'æ°´åˆ†ã€å…‰èƒ½çƒ­é‡ã€é£èƒ½å’Œå¤§æ°”â€¦',time:'2025/8/6 10:04:18'},
    {id:4,name:'æ°´èµ„æº',cat:'water',desc:'åœ°è¡¨æ°´ã€å†°å·ã€æµ·é¢å’Œåœ°ä¸‹æ°´',time:'2025/8/6 10:04:18'},
  ],
  indicators: [
    {id:1,name:'åœ°è¡¨æ°´å‚¨é‡',lvl:'1çº§æŒ‡æ ‡',rtype:'æ°´èµ„æº',pol:'æ­£å‘',unit:'ä¸‡mÂ³',desc:'åœ°è¡¨æ°´èµ„æºæ•°é‡',time:'2025/8/8 03:14:56'},
    {id:2,name:'å¹´å¤ªé˜³è¾å°„æ€»é‡',lvl:'1çº§æŒ‡æ ‡',rtype:'æ°”å€™èµ„æº',pol:'æ­£å‘',unit:'MJ/mÂ²',desc:'åæ˜ å…‰èƒ½çƒ­é‡',time:'2025/8/8 03:14:56'},
    {id:3,name:'å¹´é™æ°´æ€»é‡',lvl:'1çº§æŒ‡æ ‡',rtype:'æ°”å€™èµ„æº',pol:'æ­£å‘',unit:'mm',desc:'åæ˜ æ°”å€™èµ„æº',time:'2025/8/8 03:14:56'},
    {id:4,name:'å¹´é£èƒ½å¯†åº¦',lvl:'1çº§æŒ‡æ ‡',rtype:'æ°”å€™èµ„æº',pol:'æ­£å‘',unit:'W/mÂ²',desc:'åæ˜ é£èƒ½å¯†åº¦',time:'2025/8/8 03:14:56'},
    {id:5,name:'æ£®æ—è¦†ç›–ç‡',lvl:'1çº§æŒ‡æ ‡',rtype:'åœ°è¡¨è¦†ç›–',pol:'åå‘',unit:'%',desc:'æ—æœ¨èµ„æºæ•°é‡',time:'2025/8/8 03:14:56'},
    {id:6,name:'è€•åœ°é¢ç§¯',lvl:'1çº§æŒ‡æ ‡',rtype:'åœŸåœ°èµ„æº',pol:'æ­£å‘',unit:'hmÂ²',desc:'å†œç”¨åœ°æ•°é‡',time:'2025/8/8 03:14:56'},
    {id:7,name:'åœŸå£¤æœ‰æœºè´¨å«é‡',lvl:'2çº§æŒ‡æ ‡',rtype:'åœŸåœ°èµ„æº',pol:'æ­£å‘',unit:'g/kg',desc:'åœŸå£¤èµ„æºè´¨é‡',time:'2025/8/8 03:14:56'},
    {id:8,name:'å¤§æ°”CO2æµ“åº¦',lvl:'2çº§æŒ‡æ ‡',rtype:'æ°”å€™èµ„æº',pol:'æ­£å‘',unit:'ppm',desc:'åæ˜ å¤§æ°”æˆåˆ†',time:'2025/8/8 03:14:56'},
    {id:9,name:'æ°´è´¨æŒ‡æ•°',lvl:'2çº§æŒ‡æ ‡',rtype:'æ°´èµ„æº',pol:'æ­£å‘',unit:'æ— é‡çº²',desc:'æ°´èµ„æºè´¨é‡è¯„ä»·',time:'2025/8/8 03:14:56'},
  ],
  modules: [
    {id:1,name:'åœŸåœ°èµ„æºè´¨é‡æ¨¡å—',desc:'åŒ…å«å†œç”¨åœ°å’Œæ—è‰åˆ©ç”¨â€¦',inc:['è€•åœ°é¢ç§¯','åœŸå£¤æœ‰æœºè´¨','+1'],areas:['é™†åœ°å†°å†»åŒº','ç»¿æ´²åŒº'] ,time:'2025/8/8 03:14:56'},
    {id:2,name:'åœ°è¡¨è¦†ç›–èµ„æºæ¨¡å—',desc:'æ¶µç›–æ—æœ¨ã€è‰ã€ä½œç‰©â€¦',inc:['æ£®æ—è¦†ç›–ç‡','è‰åœ°ç”Ÿäº§åŠ›','+1'],areas:['é™†åœ°å†°å†»åŒº','ç»¿æ´²åŒº','+4'],time:'2025/8/8 03:14:56'},
    {id:3,name:'æ°”å€™èµ„æºæ•°é‡è´¨é‡æ¨¡å—',desc:'æ•´åˆæ°”å€™èµ„æºçš„æ•°é‡å’Œâ€¦',inc:['å¹´é™æ°´æ€»é‡','å¹´å¤ªé˜³è¾å°„','+3'],areas:['é™†åœ°å†°å†»åŒº','ç»¿æ´²åŒº'],time:'2025/8/8 03:14:56'},
    {id:4,name:'æ°´èµ„æºç»¼åˆæ¨¡å—',desc:'æ•´åˆåœ°è¡¨æ°´ã€å†°å·ã€æµ·â€¦',inc:['åœ°è¡¨æ°´å‚¨é‡','æ°´è´¨æŒ‡æ•°','+1'],areas:['æ°´å·Â·å†»åœŸåŒº','+2'],time:'2025/8/8 03:14:56'},
  ],
  regions: [
    {id:1,name:'ä¸œåŒ—å¤§å…´å®‰å²­æ¤è¢«è¦†ç›–åŒº',rtype:'æ¤è¢«è¦†ç›–',feat:['æŒ‡æ•°ç»„å‹: æ¸©å¸¦é’ˆå¶æ—','æ°”å€™æ¡ä»¶: æ¸©å¸¦å¤§é™†æ€§æ°”å€™','+2'],sets:['æ£®æ—è¦†ç›–ç‡','è‰åœ°ç”Ÿäº§åŠ›','+1'],time:'2025/8/8 03:14:56'},
    {id:2,name:'å†…è’™å¤é«˜åŸè£¸åœ°åŒº',rtype:'è£¸åœ°åŒº',feat:['åœ°è²Œç±»å‹: é«˜åŸä¸˜é™µ','æ¤è¢«ç¨€å°‘: è‰ä¸›å½¢å¼æ–‘å—','+2'],sets:['å¹´é™æ°´æ€»é‡','é™æ°´å˜å¼‚ç³»æ•°','+1'],time:'2025/8/8 03:14:56'},
    {id:3,name:'æ¸¤æµ·æ¹¾æµ·å²¸åŒº',rtype:'æµ·å²¸åŒº',feat:['æµ·å²¸ç±»å‹: æ·¤æ³¥è´¨æµ·æ¹¾','æ½®æ±ç‰¹å¾: æ­£è§„å•æ—¥æ½®','+2'],sets:['å†°å·é¢ç§¯','è‰åœ°ç”Ÿäº§åŠ›','+1'],time:'2025/8/8 03:14:56'},
  ],
  observations: [
    {id:1,t:'2024/1/20 13:00:00',area:'æ¸¤æµ·æ¹¾æµ·å²¸åŒº',rtype:'æ°”å€™èµ„æº',ind:'å¹´é™æ°´æ€»é‡',val:'580 mm',src:'è‡ªåŠ¨ç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:2,t:'2024/1/20 13:00:00',area:'æ¸¤æµ·æ¹¾æµ·å²¸åŒº',rtype:'åœ°è¡¨è¦†ç›–',ind:'è‰åœ°ç”Ÿäº§åŠ›',val:'2850 kg/hmÂ²',src:'å®åœ°è°ƒæŸ¥',time:'2025/8/8 03:14:56'},
    {id:3,t:'2024/1/19 15:00:00',area:'é»„æ²³ä¸‰è§’æ´²è¿‡æ¸¡åŒº',rtype:'åœ°è¡¨è¦†ç›–',ind:'æ£®æ—è¦†ç›–ç‡',val:'35.8 %',src:'é¥æ„Ÿç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:4,t:'2024/1/18 12:00:00',area:'é’è—é«˜åŸå†°å·Â·å†»åœŸåŒº',rtype:'æ°”å€™èµ„æº',ind:'å¹´å¤ªé˜³è¾å°„æ€»é‡',val:'6800 MJ/mÂ²',src:'è‡ªåŠ¨ç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:5,t:'2024/1/18 08:00:00',area:'é’è—é«˜åŸå†°å·Â·å†»åœŸåŒº',rtype:'æ°´èµ„æº',ind:'å†°å·é¢ç§¯',val:'156.7 kmÂ²',src:'é¥æ„Ÿç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:6,t:'2024/1/17 11:00:00',area:'å†…è’™å¤é«˜åŸè£¸åœ°åŒº',rtype:'æ°”å€™èµ„æº',ind:'å¹´é™æ°´æ€»é‡',val:'320 mm',src:'è‡ªåŠ¨ç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:7,t:'2024/1/17 11:00:00',area:'å†…è’™å¤é«˜åŸè£¸åœ°åŒº',rtype:'åœŸåœ°èµ„æº',ind:'è€•åœ°é¢ç§¯',val:'1250.8 hmÂ²',src:'é¥æ„Ÿç›‘æµ‹',time:'2025/8/8 03:14:56'},
    {id:8,t:'2024/1/16 09:00:00',area:'ä¸œåŒ—å¤§å…´å®‰å²­æ¤è¢«è¦†ç›–åŒº',rtype:'åœ°è¡¨è¦†ç›–',ind:'è‰åœ°ç”Ÿäº§åŠ›',val:'4250 kg/hmÂ²',src:'å®åœ°è°ƒæŸ¥',time:'2025/8/8 03:14:56'},
  ]
};

/* ========== å·¥å…·ï¼šåˆ†é¡µã€æç¤º ========== */
function paginate(arr, page=1, size=10){
  const total = arr.length, pages = Math.max(1, Math.ceil(total/size));
  const start = (page-1)*size, end = start + size;
  return {slice: arr.slice(start,end), total, pages, page, size};
}
function pager(el, state, onGoto){
  el.innerHTML = '';
  const left = document.createElement('div'); left.textContent = `å…± ${state.total} æ¡è®°å½•`;
  const prev = document.createElement('div'); prev.className='page'; prev.textContent='<'; prev.onclick=()=> onGoto(Math.max(1,state.page-1));
  const cur  = document.createElement('div'); cur.className='page active'; cur.textContent=state.page;
  const next = document.createElement('div'); next.className='page'; next.textContent='>'; next.onclick=()=> onGoto(Math.min(state.pages,state.page+1));
  const sel  = document.createElement('select'); sel.className='select'; [10,20,50].forEach(n=>{const o=document.createElement('option'); o.value=n;o.textContent=`${n} / page`; if(n===state.size) o.selected=true; sel.appendChild(o);}); sel.onchange=()=> onGoto(1, Number(sel.value));
  el.append(left, prev, cur, next, sel);
}
function toast(msg){ const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1600); }

/* ========== èµ„æºç±»å‹è¡¨ ========== */
let typesPage=1, typesSize=10;
function renderTypes(){
  const table = document.getElementById('types-table');
  const p = paginate(dataStore.types, typesPage, typesSize);
  table.innerHTML = `
    <thead><tr><th style="width:18%">åç§°</th><th style="width:14%">åˆ†ç±»</th><th>æè¿°</th><th style="width:18%">åˆ›å»ºæ—¶é—´</th><th style="width:12%">æ“ä½œ</th></tr></thead>
    <tbody>${p.slice.map(r=>`
      <tr>
        <td>${r.name}</td><td class="muted">${r.cat}</td><td>${r.desc}</td><td class="muted">${r.time}</td>
        <td><div class="actions"><span class="link" onclick="openDialog('type', ${r.id})">âœï¸ ç¼–è¾‘</span><span class="link danger" onclick="removeType(${r.id})">ğŸ—‘ åˆ é™¤</span></div></td>
      </tr>`).join('')}
    </tbody>`;
  pager(document.getElementById('types-pager'), p, (pg, sz)=>{ typesPage=pg; if(sz) typesSize=sz; renderTypes(); });
}
function removeType(id){ if(!confirm('ç¡®è®¤åˆ é™¤è¯¥èµ„æºç±»å‹ï¼Ÿ')) return; dataStore.types = dataStore.types.filter(x=>x.id!==id); toast('å·²åˆ é™¤'); renderTypes(); }

/* ========== æŒ‡æ ‡è¡¨ ========== */
let indPage=1, indSize=10;
function renderIndicators(){
  const table = document.getElementById('indicators-table');
  const p = paginate(dataStore.indicators, indPage, indSize);
  table.innerHTML = `
    <thead><tr>
      <th style="width:20%">æŒ‡æ ‡åç§°</th><th style="width:12%">çº§åˆ«</th><th style="width:12%">èµ„æºç±»å‹</th>
      <th style="width:10%">æ¥æºç±»å‹</th><th style="width:8%">å•ä½</th><th>æè¿°</th>
      <th style="width:16%">åˆ›å»ºæ—¶é—´</th><th style="width:12%">æ“ä½œ</th></tr></thead>
    <tbody>${p.slice.map(r=>`
      <tr>
        <td>${r.name}</td>
        <td><span class="badge blue">${r.lvl}</span></td>
        <td class="muted">${r.rtype}</td>
        <td><span class="badge ${r.pol==='åå‘'?'gray':'blue'}">${r.pol}</span></td>
        <td>${r.unit}</td>
        <td>${r.desc}</td>
        <td class="muted">${r.time}</td>
        <td><div class="actions"><span class="link" onclick="openDialog('indicator', ${r.id})">âœï¸ ç¼–è¾‘</span><span class="link danger" onclick="removeIndicator(${r.id})">ğŸ—‘ åˆ é™¤</span></div></td>
      </tr>`).join('')}
    </tbody>`;
  pager(document.getElementById('indicators-pager'), p, (pg, sz)=>{ indPage=pg; if(sz) indSize=sz; renderIndicators(); });
}
function removeIndicator(id){ if(!confirm('ç¡®è®¤åˆ é™¤è¯¥æŒ‡æ ‡ï¼Ÿ')) return; dataStore.indicators = dataStore.indicators.filter(x=>x.id!==id); toast('å·²åˆ é™¤'); renderIndicators(); }

/* ========== æ¨¡å—è¡¨ ========== */
let modPage=1, modSize=10;
function pills(arr){ return arr.map(t=>`<span class="badge gray">${t}</span>`).join(' '); }
function renderModules(){
  const table = document.getElementById('modules-table');
  const p = paginate(dataStore.modules, modPage, modSize);
  table.innerHTML = `
    <thead><tr><th style="width:22%">æ¨¡å—åç§°</th><th>æè¿°</th><th style="width:22%">åŒ…å«æŒ‡æ ‡</th><th style="width:20%">é€‚ç”¨åŒºåŸŸ</th><th style="width:16%">åˆ›å»ºæ—¶é—´</th><th style="width:12%">æ“ä½œ</th></tr></thead>
    <tbody>${p.slice.map(r=>`
      <tr>
        <td>${r.name}</td><td>${r.desc}</td><td>${pills(r.inc)}</td><td>${pills(r.areas)}</td><td class="muted">${r.time}</td>
        <td><div class="actions"><span class="link" onclick="openDialog('module', ${r.id})">âœï¸ ç¼–è¾‘</span><span class="link danger" onclick="removeModule(${r.id})">ğŸ—‘ åˆ é™¤</span></div></td>
      </tr>`).join('')}
    </tbody>`;
  pager(document.getElementById('modules-pager'), p, (pg, sz)=>{ modPage=pg; if(sz) modSize=sz; renderModules(); });
}
function removeModule(id){ if(!confirm('ç¡®è®¤åˆ é™¤è¯¥æ¨¡å—ï¼Ÿ')) return; dataStore.modules = dataStore.modules.filter(x=>x.id!==id); toast('å·²åˆ é™¤'); renderModules(); }

/* ========== åŒºåŸŸè¡¨ ========== */
let regPage=1, regSize=10;
function renderRegions(){
  const table = document.getElementById('regions-table');
  const p = paginate(dataStore.regions, regPage, regSize);
  table.innerHTML = `
    <thead><tr><th style="width:24%">åŒºåŸŸåç§°</th><th style="width:12%">åŒºåŸŸç±»å‹</th><th>ç‰¹å¾å‚æ•°</th><th style="width:20%">æŒ‡æ ‡é›†</th><th style="width:16%">åˆ›å»ºæ—¶é—´</th><th style="width:12%">æ“ä½œ</th></tr></thead>
    <tbody>${p.slice.map(r=>`
      <tr>
        <td>${r.name}</td><td><span class="badge blue">${r.rtype}</span></td><td>${pills(r.feat)}</td><td>${pills(r.sets)}</td><td class="muted">${r.time}</td>
        <td><div class="actions"><span class="link" onclick="openDialog('region', ${r.id})">âœï¸ ç¼–è¾‘</span><span class="link danger" onclick="removeRegion(${r.id})">ğŸ—‘ åˆ é™¤</span></div></td>
      </tr>`).join('')}
    </tbody>`;
  pager(document.getElementById('regions-pager'), p, (pg, sz)=>{ regPage=pg; if(sz) regSize=sz; renderRegions(); });
}
function removeRegion(id){ if(!confirm('ç¡®è®¤åˆ é™¤è¯¥åŒºåŸŸï¼Ÿ')) return; dataStore.regions = dataStore.regions.filter(x=>x.id!==id); toast('å·²åˆ é™¤'); renderRegions(); }

/* ========== è§‚æµ‹æ•°æ®è¡¨ ========== */
let obsPage=1, obsSize=10;
function renderObs(){
  const table = document.getElementById('obs-table');
  const p = paginate(dataStore.observations, obsPage, obsSize);
  table.innerHTML = `
    <thead><tr><th style="width:16%">è§‚æµ‹æ—¶é—´</th><th style="width:18%">åŒºåŸŸ</th><th style="width:10%">èµ„æºç±»å‹</th><th style="width:16%">æŒ‡æ ‡</th><th style="width:12%">æ•°å€¼</th><th style="width:12%">é‡‡é›†æ–¹å¼</th><th style="width:16%">åˆ›å»ºæ—¶é—´</th><th style="width:10%">æ“ä½œ</th></tr></thead>
    <tbody>${p.slice.map(r=>`
      <tr>
        <td>${r.t}</td><td class="muted">${r.area}</td><td>${r.rtype}</td><td>${r.ind}</td><td>${r.val}</td><td>${r.src}</td><td class="muted">${r.time}</td>
        <td><div class="actions"><span class="link" onclick="openDialog('ob', ${r.id})">âœï¸ ç¼–è¾‘</span><span class="link danger" onclick="removeOb(${r.id})">ğŸ—‘ åˆ é™¤</span></div></td>
      </tr>`).join('')}
    </tbody>`;
  pager(document.getElementById('obs-pager'), p, (pg, sz)=>{ obsPage=pg; if(sz) obsSize=sz; renderObs(); });
}
function removeOb(id){ if(!confirm('ç¡®è®¤åˆ é™¤è¯¥è§‚æµ‹è®°å½•ï¼Ÿ')) return; dataStore.observations = dataStore.observations.filter(x=>x.id!==id); toast('å·²åˆ é™¤'); renderObs(); }

/* ========== å¼¹çª—ï¼šæ–°å¢/ç¼–è¾‘ ========== */
const mask = document.getElementById('mask');
const dlgForm = document.getElementById('dlg-form');
const dlgTitle = document.getElementById('dlg-title');
document.querySelectorAll('[data-open="type"]').forEach(b=>b.onclick=()=>openDialog('type'));
document.querySelectorAll('[data-open="indicator"]').forEach(b=>b.onclick=()=>openDialog('indicator'));
document.querySelectorAll('[data-open="module"]').forEach(b=>b.onclick=()=>openDialog('module'));
document.querySelectorAll('[data-open="region"]').forEach(b=>b.onclick=()=>openDialog('region'));
document.querySelectorAll('[data-open="ob"]').forEach(b=>b.onclick=()=>openDialog('ob'));
document.getElementById('dlg-cancel').onclick=()=>closeDialog();

let dlgCtx={kind:'', id:null};
function openDialog(kind, id=null){
  dlgCtx={kind,id};
  mask.style.display='flex';
  const isEdit = !!id;
  const titleMap = {type:'èµ„æºç±»å‹', indicator:'æŒ‡æ ‡', module:'æ¨¡å—', region:'åŒºåŸŸ', ob:'è§‚æµ‹æ•°æ®'};
  dlgTitle.textContent = (isEdit?'ç¼–è¾‘ ':'æ–°å¢ ')+ titleMap[kind];

  const f = (n,l,t='text',ph='',val='')=>`
    <label for="${n}">${l}</label>
    ${t==='textarea'
      ? `<textarea id="${n}" placeholder="${ph}">${val||''}</textarea>`
      : t==='select'
        ? `<select id="${n}">${ph}</select>`
        : `<input id="${n}" type="${t}" placeholder="${ph}" value="${val||''}"/>`}`;

  if(kind==='type'){
    const row = isEdit ? dataStore.types.find(x=>x.id===id) : {};
    dlgForm.innerHTML = f('name','åç§°*','text','å¦‚ï¼šåœŸåœ°èµ„æº',row.name)
      + f('cat','åˆ†ç±»*','text','land/surface/climate/water',row.cat)
      + f('desc','æè¿°','textarea','æ¦‚è¿°',row.desc||'');
  }
  if(kind==='indicator'){
    const row = isEdit ? dataStore.indicators.find(x=>x.id===id) : {};
    const lvlOpts = ['1çº§æŒ‡æ ‡','2çº§æŒ‡æ ‡','3çº§æŒ‡æ ‡'].map(v=>`<option ${row.lvl===v?'selected':''}>${v}</option>`).join('');
    const rtypeOpts = ['æ°´èµ„æº','æ°”å€™èµ„æº','åœ°è¡¨è¦†ç›–','åœŸåœ°èµ„æº'].map(v=>`<option ${row.rtype===v?'selected':''}>${v}</option>`).join('');
    const polOpts = ['æ­£å‘','åå‘'].map(v=>`<option ${row.pol===v?'selected':''}>${v}</option>`).join('');
    dlgForm.innerHTML =
      f('name','æŒ‡æ ‡åç§°*','text','å¦‚ï¼šå¹´é™æ°´æ€»é‡',row.name||'')+
      f('lvl','çº§åˆ«*','select',lvlOpts)+
      f('rtype','èµ„æºç±»å‹*','select',rtypeOpts)+
      f('pol','æ¥æºç±»å‹*','select',polOpts)+
      f('unit','å•ä½*','text','mm / % / MJ/mÂ²â€¦',row.unit||'')+
      f('desc','æè¿°','textarea','ç”¨é€”æˆ–è§£é‡Š',row.desc||'');
  }
  if(kind==='module'){
    const row = isEdit ? dataStore.modules.find(x=>x.id===id) : {};
    dlgForm.innerHTML =
      f('name','æ¨¡å—åç§°*','text','å¦‚ï¼šæ°”å€™èµ„æºæ•°é‡è´¨é‡æ¨¡å—',row.name||'')+
      f('desc','æè¿°','textarea','æ¨¡å—è¯´æ˜',row.desc||'')+
      f('inc','åŒ…å«æŒ‡æ ‡(é€—å·åˆ†éš”)','text','æ£®æ—è¦†ç›–ç‡, è‰åœ°ç”Ÿäº§åŠ›, +1', row.inc?row.inc.join(', '):'')+
      f('areas','é€‚ç”¨åŒºåŸŸ(é€—å·åˆ†éš”)','text','é™†åœ°å†°å†»åŒº, ç»¿æ´²åŒº, +2', row.areas?row.areas.join(', '):'');
  }
  if(kind==='region'){
    const row = isEdit ? dataStore.regions.find(x=>x.id===id) : {};
    dlgForm.innerHTML =
      f('name','åŒºåŸŸåç§°*','text','å¦‚ï¼šæ¸¤æµ·æ¹¾æµ·å²¸åŒº',row.name||'')+
      f('rtype','åŒºåŸŸç±»å‹*','text','æµ·å²¸åŒº/è£¸åœ°åŒº/æ¤è¢«è¦†ç›–â€¦',row.rtype||'')+
      f('feat','ç‰¹å¾å‚æ•°(é€—å·åˆ†éš”)','text','åœ°è²Œç±»å‹:Ã—Ã—, æ°”å€™æ¡ä»¶:Ã—Ã—, +2', row.feat?row.feat.join(', '):'')+
      f('sets','æŒ‡æ ‡é›†(é€—å·åˆ†éš”)','text','å¹´é™æ°´æ€»é‡, æ°´è´¨æŒ‡æ•°, +1', row.sets?row.sets.join(', '):'');
  }
  if(kind==='ob'){
    const row = isEdit ? dataStore.observations.find(x=>x.id===id) : {};
    dlgForm.innerHTML =
      f('t','è§‚æµ‹æ—¶é—´*','text','YYYY/M/D HH:mm:ss',row.t||'')+
      f('area','åŒºåŸŸ*','text','å¦‚ï¼šæ¸¤æµ·æ¹¾æµ·å²¸åŒº',row.area||'')+
      f('rtype','èµ„æºç±»å‹*','text','æ°”å€™èµ„æº/åœ°è¡¨è¦†ç›–/æ°´èµ„æº/åœŸåœ°èµ„æº',row.rtype||'')+
      f('ind','æŒ‡æ ‡*','text','å¹´é™æ°´æ€»é‡/æ°´è´¨æŒ‡æ•°â€¦',row.ind||'')+
      f('val','æ•°å€¼*','text','580 mm / 35.8 % â€¦',row.val||'')+
      f('src','é‡‡é›†æ–¹å¼*','text','è‡ªåŠ¨ç›‘æµ‹/å®åœ°è°ƒæŸ¥/é¥æ„Ÿç›‘æµ‹',row.src||'');
  }
}
function closeDialog(){ mask.style.display='none'; dlgForm.innerHTML=''; dlgCtx={kind:'',id:null}; }
document.getElementById('mask').addEventListener('click', e=>{ if(e.target.id==='mask') closeDialog(); });

document.getElementById('dlg-form').addEventListener('submit', e=>{
  e.preventDefault();
  const $ = id=>document.getElementById(id)?.value?.trim();
  const now = new Date().toISOString().slice(0,19).replace('T',' ');
  const {kind,id} = dlgCtx;

  if(kind==='type'){
    const name=$('name'), cat=$('cat'); if(!name||!cat) return toast('è¯·å¡«å†™å¿…å¡«é¡¹');
    const desc=$('desc')||'';
    if(id){ Object.assign(dataStore.types.find(x=>x.id===id),{name,cat,desc}); }
    else{ dataStore.types.unshift({id:Date.now(),name,cat,desc,time:now}); }
    toast('å·²ä¿å­˜'); renderTypes(); closeDialog();
  }
  if(kind==='indicator'){
    const name=$('name'), lvl=$('lvl'), rtype=$('rtype'), pol=$('pol'), unit=$('unit'); if(!name||!lvl||!rtype||!pol||!unit) return toast('è¯·å¡«å†™å¿…å¡«é¡¹');
    const desc=$('desc')||'';
    if(id){ Object.assign(dataStore.indicators.find(x=>x.id===id),{name,lvl,rtype,pol,unit,desc}); }
    else{ dataStore.indicators.unshift({id:Date.now(),name,lvl,rtype,pol,unit,desc,time:now}); }
    toast('å·²ä¿å­˜'); renderIndicators(); closeDialog();
  }
  if(kind==='module'){
    const name=$('name'); if(!name) return toast('è¯·å¡«å†™å¿…å¡«é¡¹');
    const desc=$('desc')||'', inc=($('inc')||'').split(',').map(s=>s.trim()).filter(Boolean),
          areas=($('areas')||'').split(',').map(s=>s.trim()).filter(Boolean);
    if(id){ Object.assign(dataStore.modules.find(x=>x.id===id),{name,desc,inc,areas}); }
    else{ dataStore.modules.unshift({id:Date.now(),name,desc,inc,areas,time:now}); }
    toast('å·²ä¿å­˜'); renderModules(); closeDialog();
  }
  if(kind==='region'){
    const name=$('name'), rtype=$('rtype'); if(!name||!rtype) return toast('è¯·å¡«å†™å¿…å¡«é¡¹');
    const feat=($('feat')||'').split(',').map(s=>s.trim()).filter(Boolean),
          sets=($('sets')||'').split(',').map(s=>s.trim()).filter(Boolean);
    if(id){ Object.assign(dataStore.regions.find(x=>x.id===id),{name,rtype,feat,sets}); }
    else{ dataStore.regions.unshift({id:Date.now(),name,rtype,feat,sets,time:now}); }
    toast('å·²ä¿å­˜'); renderRegions(); closeDialog();
  }
  if(kind==='ob'){
    const t=$('t'), area=$('area'), rtype=$('rtype'), ind=$('ind'), val=$('val'), src=$('src');
    if(!t||!area||!rtype||!ind||!val||!src) return toast('è¯·å¡«å†™å¿…å¡«é¡¹');
    if(id){ Object.assign(dataStore.observations.find(x=>x.id===id),{t,area,rtype,ind,val,src}); }
    else{ dataStore.observations.unshift({id:Date.now(),t,area,rtype,ind,val,src,time:now}); }
    toast('å·²ä¿å­˜'); renderObs(); closeDialog();
  }
});

/* ========== åˆå§‹æ¸²æŸ“ ========== */
function boot(){ renderTypes(); renderIndicators(); renderModules(); renderRegions(); renderObs(); }
window.addEventListener('load', boot);
</script>
</body>
</html>
